plot.background = element_rect(color='black'))
ggplot() +
geom_polygon(data = europe, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.2, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.background = element_rect(color = 'black'),
plot.background = element_rect(color='black'))
usa <- map_data("states")
usa <- map_data("state")
View(usa)
View(usa)
usa <- usa %>%
group_by(group) %>%
mutate(mean_lat = mean(lat), mean_long = mean(long)) %>%
mutate(centered_lat = lat - mean_lat, centered_long = long - mean_long)
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.2, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.background = element_rect(color = 'black'),
plot.background = element_rect(color='black'))
View(usa)
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.2, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(color = 'black'),
plot.background = element_rect(color='black'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.2, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'black'),
plot.background = element_rect(fill = 'black'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.2, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.2, color = 'black', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='grey', alpha=.3, color = 'grey' = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'grey', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='grey', alpha=.3, color = 'grey', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='grey', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='grey', alpha=.5, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey'),
plot.background = element_rect(fill = 'grey'))
ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20'),
plot.background = element_rect(fill = 'grey20'))
ggplot() +
geom_polygon(data = europe, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20'),
plot.background = element_rect(fill = 'grey20'))
usa <- ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20'),
plot.background = element_rect(fill = 'grey20'))
usa <- map_data("state")
usa <- usa %>%
group_by(group) %>%
mutate(mean_lat = mean(lat), mean_long = mean(long)) %>%
mutate(centered_lat = lat - mean_lat, centered_long = long - mean_long)
usa_plot <- ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20'),
plot.background = element_rect(fill = 'grey20'))
europe_plot <- ggplot() +
geom_polygon(data = europe, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20'),
plot.background = element_rect(fill = 'grey20'))
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2)
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
europe_plot <- ggplot() +
geom_polygon(data = europe, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
plot.margin = unit(c(t=1,r=0,b=1,l=0), "cm"),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20'),
plot.background = element_rect(fill = 'grey20'))
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
usa_plot <- ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20', color=NA),
plot.background = element_rect(fill = 'grey20', color=NA))
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
europe_plot <- ggplot() +
geom_polygon(data = europe, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
plot.margin = unit(c(t=1,r=0,b=1,l=0), "cm"),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20', color = NA),
plot.background = element_rect(fill = 'grey20', color = NA))
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
combin_plot <- cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
ggsave('test4.png', width = 8, height = 4)
europe_plot <- ggplot() +
geom_polygon(data = europe, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
plot.margin = unit(c(t=1,r=0,b=1,l=0), "cm"),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20', color = 'grey20'),
plot.background = element_rect(fill = 'grey20', color = 'grey20'))
usa_plot <- ggplot() +
geom_polygon(data = usa, aes(x = centered_long, y = centered_lat, group = group), fill='black', alpha=.3, color = 'white', size = .5) +
coord_fixed(1.3) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank(),
axis.title.y=element_blank(),
axis.text.y=element_blank(),
axis.ticks.y=element_blank(), legend.position="bottom",
legend.key.height = unit(.25, 'cm'),
panel.background = element_rect(fill = 'grey20', color = 'grey20'),
plot.background = element_rect(fill = 'grey20', color = 'grey20'))
combin_plot <- cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
cowplot::plot_grid(europe_plot, usa_plot,
ncol = 2,
align = 'v')
ggsave('test5.png')
library(tidytext)
library(dplyr)
library(ggplot2)
library(wordcloud)
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
# read in and organize text data
data_all <- read.delim("silcton_full_apr_2021.csv", header=T, sep=",", fill=T)
text_data <- as.character(data_all$lost_resp)
text_df <- tibble(line = 1:length(text_data), text = text_data)
text_df <- filter(text_df, text != "")
text_df_count <- text_df
text_df_count$total <- sapply(text_df_count$text, function(x) length(unlist(strsplit(as.character(x), "\\W+"))))
tidy_books <- text_df %>%
unnest_tokens(word, text) %>% # 1 word per row
anti_join(stop_words) # remove common words (the, of, i, etc.)
tidy_books %>%
count(word, sort = TRUE) %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(n, word)) +
geom_col() +
labs(y = NULL)
tidy_books %>%
anti_join(stop_words) %>%
count(word) %>%
with(wordcloud(word, n, max.words = 100))
bing_word_counts <- tidy_books %>%
inner_join(get_sentiments("bing")) %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
bing_word_counts %>%
group_by(sentiment) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(n, word, fill = sentiment)) +
geom_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(x = "Contribution to sentiment",
y = NULL)
bing_word_counts_per_sub <- tidy_books %>%
group_by(line) %>%
inner_join(get_sentiments("bing")) %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
bing_word_counts_per_sub <- filter(bing_word_counts_per_sub, word != "lost" & sentiment != "positive")
bing_word_sum <- bing_word_counts_per_sub %>%
group_by(line) %>%
summarise(count_words = n())
View(bing_word_sum)
View(bing_word_counts_per_sub)
text_df <- tibble(line = 1:length(text_data), text = text_data)
View(text_df)
text_df <- filter(text_df, text != "")
text_df <- tibble(line = 1:length(text_data), text = text_data)
text_df_count <- text_df
View(text_df_count)
text_df_count$total <- sapply(text_df_count$text, function(x) length(unlist(strsplit(as.character(x), "\\W+"))))
View(text_df_count)
bing_word_counts <- tidy_books %>%
inner_join(get_sentiments("bing")) %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
View(bing_word_counts)
bing_word_counts_per_sub <- tidy_books %>%
group_by(line) %>%
inner_join(get_sentiments("bing")) %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
View(bing_word_counts_per_sub)
bing_word_counts_per_sub <- filter(bing_word_counts_per_sub, word != "lost" & sentiment != "positive")
bing_word_sum <- bing_word_counts_per_sub %>%
group_by(line) %>%
summarise(count_words = n())
View(bing_word_sum)
View(text_df_count)
write.csv(text_df_count, 'total_word_count.csv')
bing_word_sum <- bing_word_counts_per_sub %>%
group_by(line) %>%
summarise(count_words = sum(count_words))
View(bing_word_counts_per_sub)
bing_word_sum <- bing_word_counts_per_sub %>%
group_by(line) %>%
summarise(count_words = sum(n))
View(bing_word_sum)
bing_word_counts <- tidy_books %>%
inner_join(get_sentiments("afinn")) %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
bing_word_counts <- tidy_books %>%
inner_join(get_sentiments("afinn")) %>%
count(word, sentiment, sort = TRUE) %>%
ungroup()
bing_word_counts <- tidy_books %>%
inner_join(get_sentiments("afinn"))
View(bing_word_counts)
bing_word_counts <- tidy_books %>%
inner_join(get_sentiments("afinn")) %>%
count(word, value, sort = TRUE) %>%
ungroup()
View(bing_word_counts)
bing_word_counts %>%
group_by(value) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(n, word, fill = value)) +
geom_col(show.legend = FALSE) +
facet_wrap(~sentiment, scales = "free_y") +
labs(x = "Contribution to sentiment",
y = NULL)
bing_word_counts %>%
group_by(value) %>%
ungroup() %>%
mutate(word = reorder(word, n)) %>%
ggplot(aes(n, word, fill = value)) +
geom_col(show.legend = FALSE) +
facet_wrap(~value, scales = "free_y") +
labs(x = "Contribution to sentiment",
y = NULL)
View(bing_word_counts_per_sub)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
world <- map_data("world")
europe_list <- c("Albania","Austria","Belarus","Belgium","Bosnia and Herzegovina","Bulgaria","Croatia","Cyprus",
"Czech Republic","Denmark","Estonia","Finland","France",
"Germany","Greece","Hungary","Iceland","Ireland","Italy","Latvia", "Kosovo",
"Lithuania","Luxembourg","Malta","Moldova","Montenegro", "Netherlands",
"Macedonia","Norway","Poland",
"Portugal","Romania","Serbia", "Slovakia","Slovenia","Spain",
"Sweden","Switzerland", "Turkey", "UK","Ukraine")
usa <- map_data("state")
usa <- usa %>%
group_by(group) %>%
mutate(mean_lat = mean(lat), mean_long = mean(long)) %>%
mutate(centered_lat = lat - mean_lat, centered_long = long - mean_long)
View(usa)
usa_sizes <- read.csv("data/us_states_size.csv")
usa2 <- merge(usa, usa_sizes, by=c("region"))
usa2 <- merge(usa, usa_sizes, by=c("region"), x.all=T)
View(usa_sizes)
usa_sizes <- read.table("data/us_states_size.csv", header=T, sep=",")
View(usa_sizes)
usa_sizes <- read.table("data/us_states_size.csv", header=T, sep=",")
View(usa_sizes)
usa2 <- merge(usa, usa_sizes, by=c("region"), x.all=T)
usa2 <- merge(usa, usa_sizes, by=c("region"))
library(ggplot2)
library(maps)
library(mapdata)
library(mapproj)
library(cowplot)
library(dplyr)
library(sf)
usa2 <- merge(usa, usa_sizes, by=c("region"))
View(usa2)
usa_sizes <- read.table("data/us_states_size.csv", header=T, sep=",")
usa2 <- merge(usa, usa_sizes, by=c("region"))
View(usa_sizes)
View(usa)
usa_sizes$region <- as.character(usa_sizes$region)
usa2 <- merge(usa, usa_sizes, by=c("region"))
usa3 <- merge(usa, usa_sizes, by=c("region"))
usa3 <- merge(usa, usa_sizes, by=c("region"), all =T)
usa3 <- merge(usa, usa_sizes, by=c("region"), x.all =T)
usa3 <- merge(usa, usa_sizes, by=c("region"), y.all =T)
usa3 <- merge(usa, usa_sizes, by=c("region"), all =T)
View(usa3)
usa3 <- inner_join(usa, usa_sizes, by=c("region"))
library(plyr)
library(dplyr)
usa3 <- inner_join(usa, usa_sizes, by=c("region"))
usa3 <- merge(usa, usa_sizes, by=c("region"))
usa3 <- merge(usa_sizes, usa, by=c("region"))
usa$size_rank <- usa_sizes$rank[match(usa$region,usa_sizes$region)]
View(usa)
usa_sizes$region <- as.character(usa_sizes$region)
View(usa_sizes)
usa$size_rank <- usa_sizes$rank[match(usa$region,usa_sizes$region)]
View(usa)
